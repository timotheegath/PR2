\documentclass[10pt,technote]{IEEEtran}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{subcaption}

\title{Coursework 2: Representation and Distance Metrics Learning }
\author{Timothee Gathmann \textit{(\textbf{tlg15}, 01061046)}\\ and his trusty undergrad assistant Luka Lagator\textit{ ()}}

\begin{document}

\maketitle

\section{Problem formulation}
The features $X \in \mathbb{R}^{D X N}$ are readily available, and consist of a set of samples $x_i \in \mathbb{R}^D, i = 1, 2, ..., N$ corresponding to $N$ pictures of pedestrians. Each sample is assigned a ground-truth label $l(x_i) \in \mathbb{N}$ identifying the individual on the picture. The features are divided in a training subset $T$, a query subset $Q$ and a gallery subset $G$. Our goal is to minimise the retrieval error when performing retrieval experiments with the K-Nearest Neighbour algorithm \cite{Cover1967} at different ranks ($R = 1, 2, ..., 10 $), with different distance metrics. For a distance metric $d(x_i, x_j)$, a nearest neighbour $x_j$ of $x_i \in Q$ is defined as
\begin{equation}
n_k(x_i) = \min_{x_j \in G}  d(x_i, x_j), k = 1
\end{equation}
For other positive values of $k$, the $k$ nearest neighbours are returned instead.
The retrieval error at rank R is defined by
\begin{equation}
e = \frac{1}{N_Q R}\sum^{N_Q}_{i} negs(n_R(x_i), l(x_i)) 
\end{equation}
Where $neg$ is the function that returns the number of neighbours $x_j$ to $x_i$ for which $l(x_i) \neq l(x_j)$
It can be seen that, to minimise this error, the feature space has to be transformed such that all points of same label lie the closest to each other, and all points of different labels lie the furthest from each other.
We can formulate our problem as a Distance Metric Learning problem. We define the set $S = \lbrace x_i, x_j, ...\rbrace, l(x_i) = l(x_j)$ and the set $D = \lbrace x_i, x_j, ...\rbrace, l(x_i) \neq l(x_j)$
Then our problem is to solve:

\begin{equation}
\max \sum_{(x_i, x_j) \in D} d(x_i, x_j)
\end{equation}
Under the constraint
\begin{equation}
\sum_{(x_i, x_j) \in S} d(x_i, x_j) < k, k \in \mathbb{R^+}
\end{equation}
The optimisable parameters depend on which function $d(x_i, x_j)$ is chosen, as well as which $k$ was chosen.





\bibliographystyle{IEEEtran}
\bibliography{refs}
\end{document}
